language: go

go:
    - 1.9

script:
    - go test -coverprofile=coverage.txt -covermode=atomic
    - GOOS=linux GOARCH=amd64 CGO_ENABLED=0 go build

after_success:
    - bash <(curl -s https://codecov.io/bash)

addons:
    code_climate:
        repo_token: dbdf4ee7f398b306062f9fbd160fc5efc161b2a5744cd4f4a44e6aaded7ca0d8

deploy:
    provider: releases
    file:
        - derision-smtp
    skip_cleanup: true
    on:
        repo: efritz/derision-smtp
        tags: true
    api_key:
        secure: FILLMEIN
